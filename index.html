<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Platinum Store Pro — (Fallback)</title>
  <link rel="icon" href="favicon.ico" />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root{color-scheme: light dark;}
    body{font-family: "Tajawal", "Cairo", sans-serif;min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,#f8fafc,#fff);margin:0;padding:24px}
    .card{max-width:900px;width:100%;background:#fff;border-radius:12px;box-shadow:0 6px 30px rgba(2,6,23,0.08);padding:24px;direction:rtl}
    .title{font-size:20px;font-weight:700;margin-bottom:8px}
    .muted{color:#6b7280}
    pre{background:#0f172a;color:#e6eef8;padding:12px;border-radius:8px;overflow:auto}
    .btn{display:inline-block;padding:10px 16px;border-radius:8px;background:#0ea5e9;color:#fff;text-decoration:none;font-weight:600;margin-inline:6px;cursor:pointer}
    .btn-ghost{background:transparent;color:#0ea5e9;border:1px solid rgba(14,165,233,0.15)}
    .hint{margin-top:12px;color:#334155}
    #fallback-message{margin-top:18px;padding:14px;border-radius:8px;background:#fffbeb;border:1px solid #fef3c7;display:none}
    .ok{color:green;font-weight:700}
    .error{color:#b91c1c;font-weight:700}
    footer{margin-top:18px;color:#475569;font-size:13px}
  </style>
</head>
<body>
  <div class="card" role="main">
    <div style="display:flex;align-items:center;gap:12px">
      <div style="flex:1">
        <div class="title">Platinum Store Pro — صفحة جاهزة للتشغيل (نسخة احتياطية)</div>
        <div class="muted">هذه الصفحة تعمل كنسخة احتياطية عرضية إن لم يُحمّل تطبيق Angular المجمّع (bundle).</div>
      </div>
      <div style="text-align:left">
        <svg width="56" height="56" viewBox="0 0 24 24" fill="none" aria-hidden>
          <rect width="24" height="24" rx="8" fill="#0ea5e9"/>
          <path d="M7 12h10M12 7v10" stroke="#fff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
    </div>

    <div id="app-root" style="margin-top:18px">
      <!-- إذا لم يُحمّل الـ bundle فسنُعرض هذا المحتوى الافتراضي -->
      <h3 class="muted">حالة التحميل:</h3>
      <div id="status" style="margin-top:6px">يتحقق النظام من وجود حزم التطبيق...</div>

      <div id="fallback-message" aria-live="polite">
        <div style="font-weight:700">التطبيق غير مُشغّل (لم يُحمّل الـ bundle).</div>
        <div style="margin-top:8px">
          خطوات سريعة لتشغيل التطبيق بشكل صحيح:
          <ol style="margin-top:6px;padding-inline-start:18px">
            <li>ثبت الحزم محلياً: <code>npm install</code></li>
            <li>بناء المشروع: <code>npm run build</code></li>
            <liانشر محتويات مجلد <code>dist/</code> على الاستضافة (أو استخدم خدمة ستاتيك مثل GitHub Pages أو serve).</li>
          </ol>
        </div>
        <div style="margin-top:10px">
          <button class="btn" id="try-load">حاول تحميل حزمة التطبيق (محلي أو من dist)</button>
          <button class="btn btn-ghost" id="open-console">عرض تعليمات الأخطاء</button>
        </div>
        <div class="hint">إن ظهرت أخطاء في Console أو شبكات 404 فالأسماء المتوقعة لملفات الـ bundle: <code>main.js</code>, <code>runtime.js</code>, <code>polyfills.js</code> أو <code>index.js</code> داخل المسار الجذري أو داخل مجلد <code>dist/</code>.</div>
      </div>

      <pre id="console-log" style="display:none;margin-top:12px"></pre>
    </div>

    <footer>
      إذا أردت، أستطيع إنشاء نسخة index.html ثابتة أبسط أو إرشادك خطوة بخطوة لتشغيل المشروع محلياً. أو انسخ الأوامر التالية في جهازك:
      <pre>npm install
npm run build
# ثم انشر محتوى dist/ إلى الاستضافة أو شغل محلياً:
npx serve -s dist</pre>
    </footer>
  </div>

  <script>
    // حاول تحميل أحد ملفات bundle الشائعة تلقائياً، وإن فشل أظهر الرسالة الاحتياطية.
    (function () {
      const statusEl = document.getElementById('status');
      const fallbackEl = document.getElementById('fallback-message');
      const consoleEl = document.getElementById('console-log');

      const candidates = [
        '/main.js',
        '/runtime.js',
        '/polyfills.js',
        '/index.js',
        '/bundle.js',
        '/dist/main.js',
        '/dist/index.js',
        '/dist/bundle.js'
      ];

      let tried = [];
      let loaded = false;

      function log(msg) {
        tried.push(msg);
        consoleEl.textContent = tried.join('\n');
      }

      function setStatus(text, ok=false) {
        statusEl.textContent = text;
        statusEl.className = ok ? 'ok' : '';
      }

      function tryLoad(index = 0) {
        if (loaded || index >= candidates.length) {
          if (!loaded) {
            setStatus('لم يتم العثور على حزمة. عرض النسخة الاحتياطية.', false);
            fallbackEl.style.display = 'block';
            consoleEl.style.display = 'block';
          }
          return;
        }
        const src = candidates[index];
        setStatus('جاري محاولة تحميل: ' + src);
        const s = document.createElement('script');
        s.src = src;
        s.type = 'module';
        s.defer = true;
        s.onload = () => {
          loaded = true;
          setStatus('تم تحميل ' + src + ' — إذا بقيت الصفحة بيضاء فتحقق من Console.', true);
          fallbackEl.style.display = 'none';
          log('SUCCESS: ' + src + ' تم تحميله.');
        };
        s.onerror = () => {
          log('FAILED: ' + src + ' (404 أو خطأ تحميل)');
          // تجربة التالي بعد تأخير صغير
          setTimeout(() => tryLoad(index + 1), 150);
        };
        document.head.appendChild(s);
      }

      document.getElementById('try-load').addEventListener('click', () => {
        fallbackEl.style.display = 'none';
        consoleEl.style.display = 'block';
        tried = [];
        consoleEl.textContent = '';
        tryLoad(0);
      });

      document.getElementById('open-console').addEventListener('click', () => {
        alert('افتح DevTools → Console و Network لرؤية الأخطاء. ستجد أيضاً ملخص التحميل في المربع أسفل الرسالة.');
        consoleEl.style.display = 'block';
      });

      // ابدأ المحاولات تلقائياً (لن تؤذي الخادم)
      window.addEventListener('load', () => {
        // ننتظر قليلًا حتى تظهر حالة الاتصالات
        setTimeout(() => tryLoad(0), 300);
        // إذا لم ينجح بعد 1.5 ثانية نعرض الرسالة الاحتياطية
        setTimeout(() => {
          if (!loaded) {
            fallbackEl.style.display = 'block';
            consoleEl.style.display = 'block';
          }
        }, 1500);
      });
    })();
  </script>
</body>
</html>
